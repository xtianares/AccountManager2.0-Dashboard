{% set PageTitle = "Account Manager 2.0" %}
{% set PageDescription = "Live Mockups for Account Manager 2.0" %}
{% set CanonicalPage = "" %}

{% extends "MainTemplate.njk" %}

{% block MainContent %}
<section class="content-wrap wrap flex-shrink-0">
  <div class="container-fluid but-fixed">
    <div class="row">
      <div class="col-12">
        <h1 class="mb-3">Issue Work Queue</h1>
        <form class="row mb-3" id="searchForm" method="post" action="/refund/filter">
          <div class="col-12 col-md-4 col-lg-3">
            <div class="form-group">
              <label for="orderId">Order Id</label>
              <input type="text" class="form-control" id="orderId" placeholder="Enter Order ID...">
            </div>
          </div>
          <div class="col-12 col-md-4 col-lg-3">
            <div class="form-group">
              <label for="orderDetailId">Order Detail Id</label>
              <input type="text" class="form-control" id="orderDetailId" placeholder="Enter Order Detail ID...">
            </div>
          </div>
          <div class="col-12 col-md-4 col-lg-3">
            <div class="form-group">
              <label>Issue Type</label>
              <div class="dropdown dropdown-checkboxes">
                <a class="dropdown-checkboxes dropdown-toggle form-control" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></a>
                <ul class="dropdown-menu allow-focus merchant-accounts" aria-labelledby="dropdownMenuLink">
                  <li class="dropdown-item">
                    <div class="custom-control custom-checkbox">
                      <input type="checkbox" class="custom-control-input" id="customCheck1" value="-1">
                      <label class="custom-control-label" for="customCheck1">All</label>
                    </div>
                  </li>
                  <li class="dropdown-item">
                    <div class="custom-control custom-checkbox">
                      <input type="checkbox" class="custom-control-input" id="customCheck2" value="1">
                      <label class="custom-control-label" for="customCheck2">Issue Type 1</label>
                    </div>
                  </li>
                  <li class="dropdown-item">
                    <div class="custom-control custom-checkbox">
                      <input type="checkbox" class="custom-control-input" id="customCheck3" value="2">
                      <label class="custom-control-label" for="customCheck3">Isssue Type 2</label>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="col-12 col-md-4 col-lg-3">
            <div class="form-group">
              <label>Issue Statuses</label>
              <div class="dropdown dropdown-checkboxes">
                <a class="dropdown-checkboxes dropdown-toggle form-control" href="#" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></a>
                <ul class="dropdown-menu allow-focus merchant-accounts" aria-labelledby="dropdownMenuLink">
                  <li class="dropdown-item">
                    <div class="custom-control custom-checkbox">
                      <input type="checkbox" class="custom-control-input" id="customCheck4" value="-1">
                      <label class="custom-control-label" for="customCheck4">All</label>
                    </div>
                  </li>
                  <li class="dropdown-item">
                    <div class="custom-control custom-checkbox">
                      <input type="checkbox" class="custom-control-input" id="customCheck5" value="1">
                      <label class="custom-control-label" for="customCheck5">Issue Status 1</label>
                    </div>
                  </li>
                  <li class="dropdown-item">
                    <div class="custom-control custom-checkbox">
                      <input type="checkbox" class="custom-control-input" id="customCheck6" value="2">
                      <label class="custom-control-label" for="customCheck6">Isssue Status 2</label>
                    </div>
                  </li>
                </ul>
              </div>
            </div>
          </div>
          <div class="col-12 col-md-4 col-lg-3">
            <div class="form-group">
              <label for="createdDate">Created Date</label>
              <input type="text" class="form-control" id="createdDate" placeholder="Date Picker Goes here...">
            </div>
          </div>
          <div class="col-12 col-md-4 col-lg-3">
            <div class="form-group">
              <label for="assignedDate">Assigned Date</label>
              <input type="text" class="form-control" id="assignedDate" placeholder="Date Picker Goes here...">
            </div>
          </div>
          <div class="col-12 col-md-4 col-lg-3">
            <div class="form-group">
              <label for="resolvedDate">Resolved Date</label>
              <input type="text" class="form-control" id="resolvedDate" placeholder="Date Picker Goes here...">
            </div>
          </div>
          <div class="col-12 form-group">
            <button class="btn btn-primary btn-sm" type="submit">Apply Filters</button>
          </div>
        </form>
      </div>

      <div class="col-12">
        <div class="card issue-card table-responsive mb-4">
          <table class="table table-hover table-bordered mb-0 font-smaller">
            <thead class="thead-light">
              <tr>
                <th>Order Info Id</th>
                <th>Order Detail Id</th>
                <th>Issue Type</th>
                <th>Error Code</th>
                <th>Status</th>
                <th>Assigned To</th>
                <th>Created Date</th>
                <th>Assigned Date</th>
                <th>Resolved Date</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><a href="/order-details/">30030111</a></td>
                <td><a href="/course-details/">30030222</a></td>
                <td>CompletionProcessingException</td>
                <td>ErrorCode</td>
                <td>New</td>
                <td>Donna</td>
                <td>2/18/21, 3:58 PM</td>
                <td>2/18/21, 3:58 PM</td>
                <td>2/18/21, 3:58 PM</td>
                <td>
                  <a class="btn btn-outline-primary btn-sm" href="#issueDetails" data-toggle="modal">View/Edit</a>
                </td>
              </tr>
              <tr>
                <td><a href="/order-details/">30030111</a></td>
                <td><a href="/course-details/">30030222</a></td>
                <td>CompletionProcessingException</td>
                <td>ErrorCode</td>
                <td>New</td>
                <td>Donna</td>
                <td>2/18/21, 3:58 PM</td>
                <td></td>
                <td></td>
                <td>
                  <a class="btn btn-outline-primary btn-sm" href="#issueDetails" data-toggle="modal">View/Edit</a>
                </td>
              </tr>
              <tr>
                <td><a href="/order-details/">30030111</a></td>
                <td><a href="/course-details/">30030222</a></td>
                <td>UserInformationSetupRequired</td>
                <td>ErrorCode</td>
                <td>New</td>
                <td>Donna</td>
                <td>2/18/21, 3:58 PM</td>
                <td>2/18/21, 3:58 PM</td>
                <td>2/18/21, 3:58 PM</td>
                <td>
                  <a class="btn btn-outline-primary btn-sm" href="#issueDetails" data-toggle="modal">View/Edit</a>
                </td>
              </tr>
              <tr class="spacer-row">
                <td colspan="12" class="bg-light p-1"></td>
              </tr>
              <tr>
                <td><a href="/order-details/">30030333</a></td>
                <td><a href="/course-details/">30030444</a></td>
                <td>UserInformationSetupRequired</td>
                <td>ErrorCode</td>
                <td>New</td>
                <td>Donna</td>
                <td>2/18/21, 3:58 PM</td>
                <td>2/18/21, 3:58 PM</td>
                <td>2/18/21, 3:58 PM</td>
                <td>
                  <a class="btn btn-outline-primary btn-sm" href="#issueDetails" data-toggle="modal">View/Edit</a>
                </td>
              </tr>
              <tr>
                <td><a href="/order-details/">30030333</a></td>
                <td><a href="/course-details/">30030444</a></td>
                <td>SuccessfullyProcessed</td>
                <td>ErrorCode</td>
                <td>New</td>
                <td>Donna</td>
                <td>2/18/21, 3:58 PM</td>
                <td></td>
                <td></td>
                <td>
                  <a class="btn btn-outline-primary btn-sm" href="#issueDetails" data-toggle="modal">View/Edit</a>
                </td>
              </tr>
              <tr class="spacer-row">
                <td colspan="12" class="bg-light p-1"></td>
              </tr>
              <tr>
                <td><a href="/order-details/">30030555</a></td>
                <td><a href="/course-details/">30030777</a></td>
                <td>CompletionProcessingException</td>
                <td>ErrorCode</td>
                <td>New</td>
                <td>Donna</td>
                <td>2/18/21, 3:58 PM</td>
                <td>2/18/21, 3:58 PM</td>
                <td>2/18/21, 3:58 PM</td>
                <td>
                  <a class="btn btn-outline-primary btn-sm" href="#issueDetails" data-toggle="modal">View/Edit</a>
                </td>
              </tr>
              <tr>
                <td><a href="/order-details/">30030555</a></td>
                <td><a href="/course-details/">30030777</a></td>
                <td>CompletionProcessingException</td>
                <td>ErrorCode</td>
                <td>New</td>
                <td>Donna</td>
                <td>2/18/21, 3:58 PM</td>
                <td></td>
                <td></td>
                <td>
                  <a class="btn btn-outline-primary btn-sm" href="#issueDetails" data-toggle="modal">View/Edit</a>
                </td>
              </tr>
              <tr>
                <td><a href="/order-details/">30030555</a></td>
                <td><a href="/course-details/">30030777</a></td>
                <td>UserInformationSetupRequired</td>
                <td>ErrorCode</td>
                <td>New</td>
                <td>Donna</td>
                <td>2/18/21, 3:58 PM</td>
                <td>2/18/21, 3:58 PM</td>
                <td>2/18/21, 3:58 PM</td>
                <td>
                  <a class="btn btn-outline-primary btn-sm" href="#issueDetails" data-toggle="modal">View/Edit</a>
                </td>
              </tr>
            <tbody>
          </table>
        </div>

        <div class="pagination-wrap">
          <ul class="pagination justify-content-center">
            <li class="page-item disabled" id="previous"><a class="page-link" id="previousLink" disabled="" href="#">&#8592;</a></li>
            <li class="page-item active"><a class="page-link page" data-page="1" href="javascript:void(0)">1</a></li>
            <li class="page-item"><a class="page-link page" data-page="2" href="javascript:void(0)">2</a></li>
            <li class="page-item"><a class="page-link page" data-page="3" href="javascript:void(0)">3</a></li>
            <li class="page-item" id="next"><a class="page-link" id="nextLink" href="javascript:void(0)">&#8594;</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>

{% endblock %}

{% block FooterIncludes %}
<!-- Modal for more details and editing issues -->
<div class="modal fade" id="issueDetails" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="AddAuditLog" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Issue Details: <span class="text-danger">[Issue ID here]</span></h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
      </div>
      <div class="modal-body">
        <form method="post" action="#">
          <div class="card issue-card table-responsive mb-3">
            <table class="table table-hover table-sm mb-0 font-smaller">
              <thead class="thead-light">
                <tr>
                  <th>Order Info Id</th>
                  <th>Order Detail Id</th>
                  <th>Issue Type</th>
                  <th>Error Code</th>
                  <th>Created Date</th>
                  <th>Assigned Date</th>
                  <th>Resolved Date</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><a href="/order-details/">30030111</a></td>
                  <td><a href="/course-details/">30030222</a></td>
                  <td>CompletionProcessingException</td>
                  <td>ErrorCode</td>
                  <td>2/18/21, 3:58 PM</td>
                  <td>2/18/21, 3:58 PM</td>
                  <td>2/18/21, 3:58 PM</td>
                </tr>
              </tbody>
            </table>
          </div>
          <h5>Description</h5>
          <div class="alert alert-danger px-3">
            <p class="mb-0">An error occurred during the completion request to generate the course certificate for OrderDetailId: 21039900 with message: Failed to report. If you do not see an additional message with a corrective action to complete, please contact technical support for further assistance.</p>
          </div>
          <h5>Notes</h5>
          <div class="card issue-card table-responsive-lg mb-3">
            <table class="table table-hover table-sm mb-0 font-smaller">
              <thead class="thead-light">
                <tr>
                  <th>Author</th>
                  <th>Time</th>
                  <th>Notes Details</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>System</td>
                  <td>2/8/2018 12:13:06 PM</td>
                  <td><strong>This is a test.</strong> by alice.watkins</td>
                </tr>
                <tr>
                  <td>alice.watkins</td>
                  <td>2/8/2018 12:13:06 PM</td>
                  <td>Refund Requested: $15.50</td>
                </tr>
                <tr>
                  <td>christian.castanares@amersc.com</td>
                  <td>6/4/2020 2:35:16 PM</td>
                  <td>Reason changed from 'Technical' to 'Technical'</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="form-group">
            <label for="issueStatus">Status</label>
            <select class="custom-select" id="issueStatus" name="issueStatus">
              <option selected="selected" value="1">New</option>
              <option value="2">Assigned</option>
              <option value="3">Resolved</option>
              <option value="4">Won't Work</option>
            </select>
          </div>
          <div class="form-group">
            <label for="assignedTo">Assigned To</label>
            <input class="form-control" id="assignedTo" name="assignedTo" type="text" />
          </div>
          <div class="form-group">
            <label for="NoteMessage">Add New Note</label>
            <textarea class="form-control" id="NoteMessage" name="NoteMessage"></textarea>
          </div>
          <div class="text-right mt-3">
            <button type="submit" class="btn btn-outline-primary">Update Issue</button>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- Modal for viewing and adding issue notes -->
<div class="modal fade" id="issueNotes" data-backdrop="static" tabindex="-1" role="dialog" aria-labelledby="AddAuditLog" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">View/Add Notes: <span class="text-danger">[Issue ID here]</span></h4>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
      </div>
      <div class="modal-body">
        <div class="card issue-card table-responsive-lg mb-2">
          <table class="table table-hover table-sm mb-0 font-smaller">
            <thead class="thead-light">
              <tr>
                <th>Author</th>
                <th>Time</th>
                <th>Notes Details</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>alice.watkins</td>
                <td>2/8/2018 12:12:35 PM</td>
                <td>This order accessed by alice.watkins</span></td>
              </tr>
              <tr>
                <td>System</td>
                <td>2/8/2018 12:13:06 PM</td>
                <td><strong>This is a test.</strong> by alice.watkins</td>
              </tr>
              <tr>
                <td>alice.watkins</td>
                <td>2/8/2018 12:13:06 PM</td>
                <td>Refund Requested: $15.50</td>
              </tr>
              <tr>
                <td>christian.castanares@amersc.com</td>
                <td>6/4/2020 2:35:16 PM</td>
                <td>Reason changed from 'Technical' to 'Technical'</td>
              </tr>
            </tbody>
          </table>
        </div>
        <form class="mt-3" method="post" action="#">
          <label class="font-weight-bolder" for="NoteMessage">Add New Note</label>
          <textarea class="form-control" id="NoteMessage" name="NoteMessage"></textarea>
          <div class="text-right mt-3">
            <button type="submit" class="btn btn-outline-primary">Add New Note</button>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- scripts for filtering refunds -->
<script>
  $(function() {
    $(document).on('click', '.allow-focus', function (e) {
      e.stopPropagation();
    });
    // $(".dropdown-menu").on("change", "input[type='checkbox']", function() {
    //   $(this).closest("li").toggleClass("active", this.checked);
    // });
    $(".dropdown-menu").on("change", "input[type='checkbox']", function() {
      if ($(this).val() === "-1") {
        if ($(this).is(":checked")) {
          $(this).closest('.dropdown-menu').find(".custom-control-input[type=checkbox]").each(function() {
            $(this).prop('checked', true);
          });
        }
        else {
          $(this).closest('.dropdown-menu').find(".custom-control-input[type=checkbox]").each(function() {
            $(this).prop('checked', false);
          });
        }
      }
      else {
        $(this).closest('.dropdown-menu').find(".custom-control-input[value=-1]").prop('checked', false);
      }
      var selectedFilters = [];
      $(this).closest('.dropdown-menu').find(".custom-control-input[type=checkbox]:checked + label").each(function() {
         selectedFilters.push($(this).text())
      });
      if (selectedFilters.indexOf("All") > -1) {
        $(this).closest('.dropdown-checkboxes').find(".dropdown-toggle").text("All");
      }
      else {
        $(this).closest('.dropdown-checkboxes').find(".dropdown-toggle").text(selectedFilters.join(', '));
      }
    })
    $(".custom-control-input[value=-1]").each(function() {
      $(this).closest('.dropdown-menu').find(".custom-control-input[value=-1]").prop('checked', true).trigger("change");
    })
  });
</script>
{% endblock %}
